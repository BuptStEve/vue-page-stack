"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const E=require("vue"),r={componentName:"VuePageStack",pushName:"push",goName:"go",replaceName:"replace",backName:"back",forwardName:"forward"},c={action:r.pushName,n:1};/**
* @vue/shared v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/process.env.NODE_ENV!=="production"&&Object.freeze({});process.env.NODE_ENV!=="production"&&Object.freeze([]);const b=(e,o)=>{for(let s=0;s<e.length;s++)e[s](o)},O={ELEMENT:1,1:"ELEMENT",FUNCTIONAL_COMPONENT:2,2:"FUNCTIONAL_COMPONENT",STATEFUL_COMPONENT:4,4:"STATEFUL_COMPONENT",TEXT_CHILDREN:8,8:"TEXT_CHILDREN",ARRAY_CHILDREN:16,16:"ARRAY_CHILDREN",SLOTS_CHILDREN:32,32:"SLOTS_CHILDREN",TELEPORT:64,64:"TELEPORT",SUSPENSE:128,128:"SUSPENSE",COMPONENT_SHOULD_KEEP_ALIVE:256,256:"COMPONENT_SHOULD_KEEP_ALIVE",COMPONENT_KEPT_ALIVE:512,512:"COMPONENT_KEPT_ALIVE",COMPONENT:6,6:"COMPONENT"};function m(e,o,s,l){E.callWithAsyncErrorHandling(e,o,E.ErrorCodes.VNODE_HOOK,[s,l])}const I=e=>e.__isSuspense,k={ENTER:0,LEAVE:1,REORDER:2};function L(e){e.shapeFlag&=~O.COMPONENT_SHOULD_KEEP_ALIVE,e.shapeFlag&=~O.COMPONENT_KEPT_ALIVE}function S(e){return e.shapeFlag&O.SUSPENSE?e.ssContent:e}const i=[],V=E.defineComponent({name:r.componentName,__isKeepAlive:!0,emits:["back","forward"],setup(e,{slots:o,emit:s}){const l=E.getCurrentInstance(),N=l.ctx,f=l.suspense,{renderer:{p,m:T,um:A,o:{createElement:M}}}=N,w=M("div");N.activate=(n,t,a,d,h)=>{const u=n.component;T(n,t,a,k.ENTER,f),p(u.vnode,n,t,a,u,f,d,n.slotScopeIds,h),E.queuePostFlushCb(()=>{u.isDeactivated=!1,u.a&&b(u.a);const _=n.props&&n.props.onVnodeMounted;_&&m(_,u.parent,n)},f)},N.deactivate=n=>{const t=n.component;T(n,w,null,k.LEAVE,f),E.queuePostFlushCb(()=>{t.da&&b(t.da);const a=n.props&&n.props.onVnodeUnmounted;a&&m(a,t.parent,n),t.isDeactivated=!0},f)};function F(n){L(n),A(n,l,f,!0)}let C=!1,P=!1;const g=()=>{C&&(P?i[i.length-1]=S(l.subTree):c.action!=r.replaceName&&i.push(S(l.subTree)))};return E.onMounted(g),E.onUpdated(g),E.onBeforeUnmount(()=>{for(const n of i)F(n)}),()=>{if(C=!1,P=!1,!o.default)return null;const n=o.default(),t=n[0];if(n.length>1)return n;if(!E.isVNode(t)||!(t.shapeFlag&O.STATEFUL_COMPONENT)&&!(t.shapeFlag&O.SUSPENSE))return t;let a=S(t);if(a.el&&(a=E.cloneVNode(a),t.shapeFlag&O.SUSPENSE&&(t.ssContent=a)),C=!0,c.action===r.backName){s("back");const d=-c.n,h=i[i.length-d-1];a.el=h.el,a.component=h.component,a.transition&&E.setTransitionHooks(a,a.transition),a.shapeFlag|=O.COMPONENT_KEPT_ALIVE;for(let u=i.length-d;u<i.length;u++)L(i[u]),i[u]=null;i.splice(i.length-d),P=!0}else s("forward");return a.shapeFlag|=O.COMPONENT_SHOULD_KEEP_ALIVE,I(t.type)?t:a}}}),R=e=>{const o=e.push.bind(e),s=e.go.bind(e),l=e.replace.bind(e),N=e.back.bind(e),f=e.forward.bind(e);e.push=p=>(c.action=r.pushName,o(p)),e.go=p=>{c.action=r.goName,p<0&&(c.action=r.backName,c.n=p),s(p)},e.replace=p=>(c.action=r.replaceName,l(p)),e.back=()=>{c.action=r.backName,c.n=-1,N()},e.forward=()=>{c.action=r.forwardName,f()}},U={install(e,{router:o,backCallback:s,forwardCallback:l}={router:null,backCallback:null,forwardCallback:null}){if(!o)throw Error("router is required");let N=null;o.options.history.listen((f,p,T)=>{N=T}),o.beforeEach(()=>{N&&(N.direction==="back"&&s?s():N.direction==="forward"&&l&&l(),N=null)})}},D=()=>{c.n=-1,c.action=r.backName,console.log("browser back")},H=()=>{c.action=r.forwardName,console.log("browser forward")},K={install(e,{router:o}){if(!o)throw Error(`
 vue-router is necessary. 

`);e.component(r.componentName,V),e.use(U,{router:o,backCallback:D,forwardCallback:H}),R(o)}};exports.VuePageStack=V;exports.VuePageStackPlugin=K;
