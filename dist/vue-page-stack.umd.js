(function(d,a){typeof exports=="object"&&typeof module<"u"?a(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],a):(d=typeof globalThis<"u"?globalThis:d||self,a(d.VuePageStack={},d.Vue))})(this,function(d,a){"use strict";const i={componentName:"VuePageStack",keyName:"stack-key",pushName:"push",goName:"go",replaceName:"replace",backName:"back",forwardName:"forward"},r={action:i.pushName,n:1};/**
* @vue/shared v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/process.env.NODE_ENV!=="production"&&Object.freeze({}),process.env.NODE_ENV!=="production"&&Object.freeze([]);const C=(e,s)=>{for(let c=0;c<e.length;c++)e[c](s)},O={ELEMENT:1,1:"ELEMENT",FUNCTIONAL_COMPONENT:2,2:"FUNCTIONAL_COMPONENT",STATEFUL_COMPONENT:4,4:"STATEFUL_COMPONENT",TEXT_CHILDREN:8,8:"TEXT_CHILDREN",ARRAY_CHILDREN:16,16:"ARRAY_CHILDREN",SLOTS_CHILDREN:32,32:"SLOTS_CHILDREN",TELEPORT:64,64:"TELEPORT",SUSPENSE:128,128:"SUSPENSE",COMPONENT_SHOULD_KEEP_ALIVE:256,256:"COMPONENT_SHOULD_KEEP_ALIVE",COMPONENT_KEPT_ALIVE:512,512:"COMPONENT_KEPT_ALIVE",COMPONENT:6,6:"COMPONENT"};function k(e,s,c,E){a.callWithAsyncErrorHandling(e,s,a.ErrorCodes.VNODE_HOOK,[c,E])}const M=e=>e.__isSuspense,_={ENTER:0,LEAVE:1,REORDER:2};function b(e){e.shapeFlag&=~O.COMPONENT_SHOULD_KEEP_ALIVE,e.shapeFlag&=~O.COMPONENT_KEPT_ALIVE}function P(e){return e.shapeFlag&O.SUSPENSE?e.ssContent:e}const l=[],L=a.defineComponent({name:i.componentName,__isKeepAlive:!0,emits:["back","forward"],setup(e,{slots:s,emit:c}){const E=a.getCurrentInstance(),N=E.ctx,f=E.suspense,{renderer:{p:u,m:h,um:D,o:{createElement:H}}}=N,y=H("div");N.activate=(n,t,o,T,g)=>{const p=n.component;h(n,t,o,_.ENTER,f),u(p.vnode,n,t,o,p,f,T,n.slotScopeIds,g),a.queuePostFlushCb(()=>{p.isDeactivated=!1,p.a&&C(p.a);const A=n.props&&n.props.onVnodeMounted;A&&k(A,p.parent,n)},f)},N.deactivate=n=>{const t=n.component;h(n,y,null,_.LEAVE,f),a.queuePostFlushCb(()=>{t.da&&C(t.da);const o=n.props&&n.props.onVnodeUnmounted;o&&k(o,t.parent,n),t.isDeactivated=!0},f)};function K(n){b(n),D(n,E,f,!0)}let S=!1,m=!1;const V=()=>{S&&(m?l[l.length-1]=P(E.subTree):r.action!=i.replaceName&&l.push(P(E.subTree)))};return a.onMounted(V),a.onUpdated(V),a.onBeforeUnmount(()=>{for(const n of l)K(n)}),()=>{if(S=!1,m=!1,!s.default)return null;const n=s.default(),t=n[0];if(n.length>1)return n;if(!a.isVNode(t)||!(t.shapeFlag&O.STATEFUL_COMPONENT)&&!(t.shapeFlag&O.SUSPENSE))return t;let o=P(t);if(o.el&&(o=a.cloneVNode(o),t.shapeFlag&O.SUSPENSE&&(t.ssContent=o)),S=!0,r.action===i.backName){c("back");const T=-r.n,g=l[l.length-T-1];o.el=g.el,o.component=g.component,o.transition&&a.setTransitionHooks(o,o.transition),o.shapeFlag|=O.COMPONENT_KEPT_ALIVE;for(let p=l.length-T;p<l.length;p++)b(l[p]),l[p]=null;l.splice(l.length-T),m=!0}else c("forward");return o.shapeFlag|=O.COMPONENT_SHOULD_KEEP_ALIVE,M(t.type)?t:o}}}),w=e=>{const s=e.push.bind(e),c=e.go.bind(e),E=e.replace.bind(e),N=e.back.bind(e),f=e.forward.bind(e);e.push=u=>(console.log("push"),r.action=i.pushName,s(u)),e.go=u=>{r.action=i.goName,u<0&&(r.action=i.backName,r.n=u),c(u)},e.replace=u=>(r.action=i.replaceName,E(u)),e.back=()=>{console.log("back"),r.action=i.backName,r.n=-1,N()},e.forward=()=>{console.log("forward"),r.action=i.forwardName,f()}},F={install(e,{router:s,backCallback:c,forwardCallback:E}={router:null,backCallback:null,forwardCallback:null}){if(!s)throw Error("router is required");let N=null;s.options.history.listen((f,u,h)=>{N=h}),s.beforeEach(()=>{N&&(N.direction==="back"&&c?c():N.direction==="forward"&&E&&E(),N=null)})}},I=()=>{r.n=-1,r.action=i.backName,console.log("browser back")},R=()=>{r.action=i.forwardName,console.log("browser forward")},U={install(e,{router:s,name:c=i.componentName}){if(!s)throw Error(`
 vue-router is necessary. 

`);e.component(c,L),e.use(F,{router:s,backCallback:I,forwardCallback:R}),w(s)}};d.VuePageStack=L,d.VuePageStackPlugin=U,Object.defineProperty(d,Symbol.toStringTag,{value:"Module"})});
