(function(O,s){typeof exports=="object"&&typeof module<"u"?s(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],s):(O=typeof globalThis<"u"?globalThis:O||self,s(O.VuePageStack={},O.Vue))})(this,function(O,s){"use strict";const i={componentName:"VuePageStack",pushName:"push",goName:"go",replaceName:"replace",backName:"back",forwardName:"forward"},r={action:i.pushName,n:1};/**
* @vue/shared v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/process.env.NODE_ENV!=="production"&&Object.freeze({}),process.env.NODE_ENV!=="production"&&Object.freeze([]);const m=(e,c)=>{for(let l=0;l<e.length;l++)e[l](c)},f={ELEMENT:1,1:"ELEMENT",FUNCTIONAL_COMPONENT:2,2:"FUNCTIONAL_COMPONENT",STATEFUL_COMPONENT:4,4:"STATEFUL_COMPONENT",TEXT_CHILDREN:8,8:"TEXT_CHILDREN",ARRAY_CHILDREN:16,16:"ARRAY_CHILDREN",SLOTS_CHILDREN:32,32:"SLOTS_CHILDREN",TELEPORT:64,64:"TELEPORT",SUSPENSE:128,128:"SUSPENSE",COMPONENT_SHOULD_KEEP_ALIVE:256,256:"COMPONENT_SHOULD_KEEP_ALIVE",COMPONENT_KEPT_ALIVE:512,512:"COMPONENT_KEPT_ALIVE",COMPONENT:6,6:"COMPONENT"};function k(e,c,l,E){s.callWithAsyncErrorHandling(e,c,s.ErrorCodes.VNODE_HOOK,[l,E])}const b=e=>e.__isSuspense,L={ENTER:0,LEAVE:1,REORDER:2};function _(e){e.shapeFlag&=~f.COMPONENT_SHOULD_KEEP_ALIVE,e.shapeFlag&=~f.COMPONENT_KEPT_ALIVE}function P(e){return e.shapeFlag&f.SUSPENSE?e.ssContent:e}const t=[],V=s.defineComponent({name:i.componentName,__isKeepAlive:!0,emits:["back","forward"],setup(e,{slots:c,emit:l}){const E=s.getCurrentInstance(),N=E.ctx,d=E.suspense,{renderer:{p,m:S,um:D,o:{createElement:H}}}=N,y=H("div");N.activate=(n,a,o,T,h)=>{const u=n.component;S(n,a,o,L.ENTER,d),p(u.vnode,n,a,o,u,d,T,n.slotScopeIds,h),s.queuePostFlushCb(()=>{u.isDeactivated=!1,u.a&&m(u.a);const M=n.props&&n.props.onVnodeMounted;M&&k(M,u.parent,n)},d)},N.deactivate=n=>{const a=n.component;S(n,y,null,L.LEAVE,d),s.queuePostFlushCb(()=>{a.da&&m(a.da);const o=n.props&&n.props.onVnodeUnmounted;o&&k(o,a.parent,n),a.isDeactivated=!0},d)};function K(n){_(n),D(n,E,d,!0)}let g=!1,C=!1;const A=()=>{g&&(C?t[t.length-1]=P(E.subTree):r.action!=i.replaceName?t.push(P(E.subTree)):t[t.length-1]=P(E.subTree))};return s.onMounted(A),s.onUpdated(A),s.onBeforeUnmount(()=>{for(const n of t)K(n)}),()=>{if(g=!1,C=!1,!c.default)return null;const n=c.default(),a=n[0];if(n.length>1)return n;if(!s.isVNode(a)||!(a.shapeFlag&f.STATEFUL_COMPONENT)&&!(a.shapeFlag&f.SUSPENSE))return a;let o=P(a);if(o.el&&(o=s.cloneVNode(o),a.shapeFlag&f.SUSPENSE&&(a.ssContent=o)),g=!0,r.action===i.backName){l("back");const T=-r.n,h=t[t.length-T-1];if(!h||h.key!=a.key)return _(t[t.length-T]),t[t.length-T]=null,t.splice(t.length-T),o.shapeFlag|=f.COMPONENT_SHOULD_KEEP_ALIVE,b(a.type)?a:o;o.el=h.el,o.component=h.component,o.transition&&s.setTransitionHooks(o,o.transition),o.shapeFlag|=f.COMPONENT_KEPT_ALIVE;for(let u=t.length-T;u<t.length;u++)_(t[u]),t[u]=null;t.splice(t.length-T),C=!0}else l("forward");return o.shapeFlag|=f.COMPONENT_SHOULD_KEEP_ALIVE,b(a.type)?a:o}}}),F=e=>{const c=e.push.bind(e),l=e.go.bind(e),E=e.replace.bind(e),N=e.back.bind(e),d=e.forward.bind(e);e.push=p=>(r.action=i.pushName,c(p)),e.go=p=>{p>0&&(r.action=i.forwardName),p<0&&(r.action=i.backName),r.n=p,l(p)},e.replace=p=>(r.action=i.replaceName,E(p)),e.back=()=>{r.action=i.backName,r.n=-1,N()},e.forward=()=>{r.action=i.forwardName,d()}},I={install(e,{router:c,backCallback:l,forwardCallback:E}={router:null,backCallback:null,forwardCallback:null}){if(!c)throw Error("router is required");let N=null;c.options.history.listen((d,p,S)=>{N=S}),c.beforeEach(()=>{N&&(N.direction==="back"&&l?l(N.delta):N.direction==="forward"&&E&&E(N.delta),N=null)})}},R=e=>{r.n=e,r.action=i.backName},U=e=>{r.n=e,r.action=i.forwardName},w={install(e,{router:c}){if(!c)throw Error(`
 vue-router is necessary. 

`);e.component(i.componentName,V),e.use(I,{router:c,backCallback:R,forwardCallback:U}),F(c)}};O.VuePageStack=V,O.VuePageStackPlugin=w,Object.defineProperty(O,Symbol.toStringTag,{value:"Module"})});
