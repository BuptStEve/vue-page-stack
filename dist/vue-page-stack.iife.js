var VuePageStack=function(T,l){"use strict";const r={componentName:"VuePageStack",keyName:"stack-key",pushName:"push",goName:"go",replaceName:"replace",backName:"back",forwardName:"forward"},s={action:r.pushName,n:1};/**
* @vue/shared v3.4.19
* (c) 2018-present Yuxi (Evan) You and Vue contributors
* @license MIT
**/process.env.NODE_ENV!=="production"&&Object.freeze({}),process.env.NODE_ENV!=="production"&&Object.freeze([]);const k=(e,t)=>{for(let c=0;c<e.length;c++)e[c](t)},O={ELEMENT:1,1:"ELEMENT",FUNCTIONAL_COMPONENT:2,2:"FUNCTIONAL_COMPONENT",STATEFUL_COMPONENT:4,4:"STATEFUL_COMPONENT",TEXT_CHILDREN:8,8:"TEXT_CHILDREN",ARRAY_CHILDREN:16,16:"ARRAY_CHILDREN",SLOTS_CHILDREN:32,32:"SLOTS_CHILDREN",TELEPORT:64,64:"TELEPORT",SUSPENSE:128,128:"SUSPENSE",COMPONENT_SHOULD_KEEP_ALIVE:256,256:"COMPONENT_SHOULD_KEEP_ALIVE",COMPONENT_KEPT_ALIVE:512,512:"COMPONENT_KEPT_ALIVE",COMPONENT:6,6:"COMPONENT"};function _(e,t,c,E){l.callWithAsyncErrorHandling(e,t,l.ErrorCodes.VNODE_HOOK,[c,E])}const M=e=>e.__isSuspense,b={ENTER:0,LEAVE:1,REORDER:2};function m(e){e.shapeFlag&=~O.COMPONENT_SHOULD_KEEP_ALIVE,e.shapeFlag&=~O.COMPONENT_KEPT_ALIVE}function P(e){return e.shapeFlag&O.SUSPENSE?e.ssContent:e}const i=[],L=l.defineComponent({name:r.componentName,__isKeepAlive:!0,emits:["back","forward"],setup(e,{slots:t,emit:c}){const E=l.getCurrentInstance(),N=E.ctx,f=E.suspense,{renderer:{p:u,m:g,um:D,o:{createElement:H}}}=N,y=H("div");N.activate=(n,o,a,d,h)=>{const p=n.component;g(n,o,a,b.ENTER,f),u(p.vnode,n,o,a,p,f,d,n.slotScopeIds,h),l.queuePostFlushCb(()=>{p.isDeactivated=!1,p.a&&k(p.a);const A=n.props&&n.props.onVnodeMounted;A&&_(A,p.parent,n)},f)},N.deactivate=n=>{const o=n.component;g(n,y,null,b.LEAVE,f),l.queuePostFlushCb(()=>{o.da&&k(o.da);const a=n.props&&n.props.onVnodeUnmounted;a&&_(a,o.parent,n),o.isDeactivated=!0},f)};function K(n){m(n),D(n,E,f,!0)}let S=!1,C=!1;const V=()=>{S&&(C?i[i.length-1]=P(E.subTree):s.action!=r.replaceName&&i.push(P(E.subTree)))};return l.onMounted(V),l.onUpdated(V),l.onBeforeUnmount(()=>{for(const n of i)K(n)}),()=>{if(S=!1,C=!1,!t.default)return null;const n=t.default(),o=n[0];if(n.length>1)return n;if(!l.isVNode(o)||!(o.shapeFlag&O.STATEFUL_COMPONENT)&&!(o.shapeFlag&O.SUSPENSE))return o;let a=P(o);if(a.el&&(a=l.cloneVNode(a),o.shapeFlag&O.SUSPENSE&&(o.ssContent=a)),S=!0,s.action===r.backName){c("back");const d=-s.n,h=i[i.length-d-1];a.el=h.el,a.component=h.component,a.transition&&l.setTransitionHooks(a,a.transition),a.shapeFlag|=O.COMPONENT_KEPT_ALIVE;for(let p=i.length-d;p<i.length;p++)m(i[p]),i[p]=null;i.splice(i.length-d),C=!0}else c("forward");return a.shapeFlag|=O.COMPONENT_SHOULD_KEEP_ALIVE,M(o.type)?o:a}}}),w=e=>{const t=e.push.bind(e),c=e.go.bind(e),E=e.replace.bind(e),N=e.back.bind(e),f=e.forward.bind(e);e.push=u=>(console.log("push"),s.action=r.pushName,t(u)),e.go=u=>{s.action=r.goName,u<0&&(s.action=r.backName,s.n=u),c(u)},e.replace=u=>(s.action=r.replaceName,E(u)),e.back=()=>{console.log("back"),s.action=r.backName,s.n=-1,N()},e.forward=()=>{console.log("forward"),s.action=r.forwardName,f()}},F={install(e,{router:t,backCallback:c,forwardCallback:E}={router:null,backCallback:null,forwardCallback:null}){if(!t)throw Error("router is required");let N=null;t.options.history.listen((f,u,g)=>{N=g}),t.beforeEach(()=>{N&&(N.direction==="back"&&c?c():N.direction==="forward"&&E&&E(),N=null)})}},I=()=>{s.n=-1,s.action=r.backName,console.log("browser back")},R=()=>{s.action=r.forwardName,console.log("browser forward")},U={install(e,{router:t,name:c=r.componentName}){if(!t)throw Error(`
 vue-router is necessary. 

`);e.component(c,L),e.use(F,{router:t,backCallback:I,forwardCallback:R}),w(t)}};return T.VuePageStack=L,T.VuePageStackPlugin=U,Object.defineProperty(T,Symbol.toStringTag,{value:"Module"}),T}({},Vue);
