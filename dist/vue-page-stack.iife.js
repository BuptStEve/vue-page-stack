var VuePageStack=function(E,U){"use strict";const a={componentName:"VuePageStack",keyName:"stack-key",pushName:"push",goName:"go",replaceName:"replace",backName:"back",forwardName:"forward"};var T;(function(e){e[e.ELEMENT=1]="ELEMENT",e[e.FUNCTIONAL_COMPONENT=2]="FUNCTIONAL_COMPONENT",e[e.STATEFUL_COMPONENT=4]="STATEFUL_COMPONENT",e[e.TEXT_CHILDREN=8]="TEXT_CHILDREN",e[e.ARRAY_CHILDREN=16]="ARRAY_CHILDREN",e[e.SLOTS_CHILDREN=32]="SLOTS_CHILDREN",e[e.TELEPORT=64]="TELEPORT",e[e.SUSPENSE=128]="SUSPENSE",e[e.COMPONENT_SHOULD_KEEP_ALIVE=256]="COMPONENT_SHOULD_KEEP_ALIVE",e[e.COMPONENT_KEPT_ALIVE=512]="COMPONENT_KEPT_ALIVE",e[e.COMPONENT=6]="COMPONENT"})(T||(T={}));const A=(e,n)=>{for(let r=0;r<e.length;r++)e[r](n)};function V(e,n,r,o){E.callWithAsyncErrorHandling(e,n,x.VNODE_HOOK,[r,o])}const S=e=>e.__isSuspense,R={ENTER:0,LEAVE:1,REORDER:2},x={SETUP_FUNCTION:0,RENDER_FUNCTION:1,WATCH_GETTER:2,WATCH_CALLBACK:3,WATCH_CLEANUP:4,NATIVE_EVENT_HANDLER:5,COMPONENT_EVENT_HANDLER:6,VNODE_HOOK:7};function y(e){e.shapeFlag&=~T.COMPONENT_SHOULD_KEEP_ALIVE,e.shapeFlag&=~T.COMPONENT_KEPT_ALIVE}function m(e){return e.shapeFlag&T.SUSPENSE?e.ssContent:e}const i=[],h=e=>{for(let n=0;n<i.length;n++)if(i[n].key===e)return n;return-1},D=e=>E.defineComponent({name:a.componentName,__isKeepAlive:!0,setup(n,{slots:r}){const o=E.getCurrentInstance(),c=o.ctx,O=o.suspense,{renderer:{p:l,m:H,um:K,o:{createElement:q}}}=c,w=q("div");c.activate=(t,p,_,N,s)=>{const u=t.component;H(t,p,_,R.ENTER,O),l(u.vnode,t,p,_,u,O,N,t.slotScopeIds,s),E.queuePostFlushCb(()=>{u.isDeactivated=!1,u.a&&A(u.a);const f=t.props&&t.props.onVnodeMounted;f&&V(f,u.parent,t)},O)},c.deactivate=t=>{const p=t.component;H(t,w,null,R.LEAVE,O),E.queuePostFlushCb(()=>{p.da&&A(p.da);const _=t.props&&t.props.onVnodeUnmounted;_&&V(_,p.parent,t),p.isDeactivated=!0},O)};function M(t){y(t),K(t,o,O,!0)}let C=null,L=!1;const k=()=>{C!=null&&(L?i[i.length-1].vnode=m(o.subTree):i.push({key:C,vnode:m(o.subTree)}))};return E.onMounted(k),E.onUpdated(k),E.onBeforeUnmount(()=>{for(const t of i)M(t.vnode)}),()=>{C=null,L=!1;const p=U.useRoute().query[e];if(!r.default)return null;const _=r.default(),N=_[0];if(_.length>1)return _;if(!E.isVNode(N)||!(N.shapeFlag&T.STATEFUL_COMPONENT)&&!(N.shapeFlag&T.SUSPENSE))return N;let s=m(N);s.el&&(s=E.cloneVNode(s),N.shapeFlag&T.SUSPENSE&&(N.ssContent=s)),C=p;let u=h(p);if(u!==-1){const f=i[u].vnode;s.el=f.el,s.component=f.component,s.transition&&E.setTransitionHooks(s,s.transition),s.shapeFlag|=T.COMPONENT_KEPT_ALIVE;for(let P=u+1;P<i.length;P++)M(i[P].vnode),i[P]=null;i.splice(u+1),L=!0}return s.shapeFlag|=T.COMPONENT_SHOULD_KEEP_ALIVE,S(N.type)?N:s}}}),d={action:a.pushName},b=e=>{const n=e.push.bind(e),r=e.go.bind(e),o=e.replace.bind(e),c=e.back.bind(e),O=e.forward.bind(e);e.push=l=>(d.action=a.pushName,n(l)),e.go=l=>{d.action=a.goName,r(l)},e.replace=l=>(d.action=a.replaceName,o(l)),e.back=()=>{d.action=a.backName,c()},e.forward=()=>{d.action=a.forwardName,O()}};function I(e,n){return!!e[n]}function g(e){return e.replace(/[xy]/g,n=>{const r=Math.random()*16|0;return(n==="x"?r:r&3|8).toString(16)})}return{install(e,{router:n,name:r=a.componentName,keyName:o=a.keyName}){if(!n)throw Error(`
 vue-router is necessary. 

`);e.component(r,D(o)),b(n),n.beforeEach((c,O)=>{if(I(c.query,o))h(c.query[o])===-1?c.params[o+"-dir"]=a.forwardName:c.params[o+"-dir"]=a.backName;else{c.query[o]=g("xxxxxxxx");const l=d.action===a.replaceName||!I(O.query,o);return{hash:c.hash,path:c.path,name:c.name,params:c.params,query:c.query,meta:c.meta,replace:l}}})}}}(Vue,vueRouter);
//# sourceMappingURL=vue-page-stack.iife.js.map
